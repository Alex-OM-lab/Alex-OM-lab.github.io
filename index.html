<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Alejandro Orcajada Meseguer | Administrador de Sistemas y Ciberseguridad</title>
  <meta name="description" content="Portafolio profesional de Alejandro Orcajada Meseguer, Administrador de Sistemas y Ciberseguridad." />

  <style>
    /* ===== PALETA OSCURA CÁLIDA (azul profundo + naranjas) ===== */
    :root{
      --bg:#0b1220;
      --panel:#111a2d;
      --text:#e9eef6;
      --muted:#a8b2c2;
      --accent:#ff9f1a;
      --accent-soft:#ffd79a;
      --radius:14px;

      /* tamaños menú */
      --nav-font:15.5px;
      --nav-pad-y:12px;
      --nav-gap:12px;

      /* hero offset */
      --hero-offset:12vh;
    }

    *{box-sizing:border-box}
    html,body{margin:0}
    body{
      font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Inter,"Helvetica Neue",Arial;
      background:
        radial-gradient(1400px 800px at 80% -100px, rgba(255,159,26,.06), transparent 60%),
        radial-gradient(1200px 700px at -200px 20%, rgba(255,215,154,.05), transparent 60%),
        var(--bg);
      color:var(--text)
    }

    /* ====== TOPBAR ====== */
    .topbar{
      position:sticky;top:0;z-index:100;
      backdrop-filter:saturate(160%) blur(8px);
      background:rgba(9,14,26,.74);
      border-bottom:1px solid rgba(255,255,255,.06);
      animation:topbarDrop .5s ease both;
    }
    .topbar::after{
      content:""; position:absolute; left:0; right:0; bottom:0;
      height:3px;
      background:linear-gradient(90deg, rgba(255,159,26,.0) 0%, rgba(255,159,26,.85) 22%, rgba(255,215,154,.9) 50%, rgba(255,159,26,.85) 78%, rgba(255,159,26,.0) 100%);
      box-shadow:0 0 10px rgba(255,159,26,.35), 0 0 20px rgba(255,159,26,.22);
      pointer-events:none;
    }
    @keyframes topbarDrop{from{transform:translateY(-8px);opacity:0}to{transform:none;opacity:1}}

    .topwrap{
      width:min(1100px,92%);margin:0 auto;
      display:flex;align-items:center;justify-content:space-between;
      padding:calc(var(--nav-pad-y) - 2px) 0;
      position:relative;
    }

    .brand{display:flex;align-items:center;gap:10px;font-weight:800;color:var(--text);text-decoration:none}
    .brand-dot{width:10px;height:10px;border-radius:999px;background:var(--accent);box-shadow:0 0 16px var(--accent)}

    .menu-left{display:flex;gap:var(--nav-gap);flex-wrap:wrap;align-items:center}
    .menu-right{display:flex;align-items:center}

    /* ====== NAV LINKS ====== */
    .nav-link{
      color:var(--text);text-decoration:none;
      padding:8px 14px;border-radius:999px;font-weight:700;
      font-size:var(--nav-font);
      border:1px solid transparent;
      transition:transform .12s,background .2s,border-color .2s,color .2s;
    }
    .nav-link:hover{
      transform:translateY(-1px);
      background:rgba(255,159,26,.12);
      border-color:rgba(255,159,26,.35);
      color:var(--accent-soft)
    }

    .nav-folder{position:relative}
    .nav-btn{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 14px;border-radius:999px;border:1px solid transparent;
      background:transparent;color:var(--text);
      font-weight:800;font-size:var(--nav-font);
      cursor:pointer;transition:transform .12s,background .2s,border-color .2s
    }
    .nav-btn:hover{transform:translateY(-1px);background:rgba(255,159,26,.12);border-color:rgba(255,159,26,.35)}
    .nav-btn-link{color:var(--text);text-decoration:none;font-weight:800;transition:color .2s ease}
    .nav-btn-link:hover{color:var(--accent-soft)}
    .ico-folder{width:14px;height:12px;position:relative;display:inline-block}
    .ico-folder::before{content:"";position:absolute;inset:0;border-radius:3px;background:rgba(255,159,26,.15);border:1px solid rgba(255,159,26,.35)}
    .ico-folder::after{content:"";position:absolute;width:8px;height:3px;left:2px;top:-3px;border-radius:2px 2px 0 0;background:rgba(255,159,26,.35)}
    .caret{width:10px;height:10px;border-right:2px solid var(--accent);border-bottom:2px solid var(--accent);
      transform:rotate(-45deg) translateY(-1px);transition:transform .2s ease}

    /* ====== POPOVER BASE ====== */
    .sub{position:absolute;top:100%;left:0;min-width:360px;padding-top:0}
    .sub::before{content:"";position:absolute;top:-10px;left:0;right:0;height:12px}
    .sub::after{content:""; position:absolute; top:0; left:100%; width:20px; height:100%; background:transparent; pointer-events:auto;}

    .sub>ul{
      list-style:none;margin:0;padding:8px;background:rgba(17,26,45,.98);
      border:1px solid rgba(255,255,255,.06);border-radius:12px;box-shadow:0 12px 30px rgba(0,0,0,.35);
      transform-origin:top left;transform:scaleY(.92);opacity:0;max-height:0;overflow:hidden;
      transition:transform .2s ease,opacity .2s ease,max-height .32s ease;
    }
    .sub a{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:10px 12px;border-radius:8px;
      text-decoration:none;color:var(--text);border:1px solid transparent}
    .sub a:hover{background:rgba(255,159,26,.1);border-color:rgba(255,159,26,.25)}
    .nav-folder[aria-open="true"] > .sub > ul{pointer-events:auto;transform:scaleY(1);opacity:1;max-height:80vh;overflow:auto}
    .nav-folder[aria-open="true"] > .nav-btn .caret{transform:rotate(45deg)}

    /* ====== NIVEL 2 (vertical) ====== */
    .nested{
      max-height:0; opacity:0; transform:translateY(-4px);
      overflow:hidden; margin-top:6px; padding-left:10px;
      border-left:2px dashed rgba(255,159,26,.25);
      transition:max-height .28s ease, opacity .22s ease, transform .22s ease;
    }
    .sub li.open > .nested{ max-height:1200px; opacity:1; transform:none; }

    /* ====== PANEL LATERAL NIVEL 3 ====== */
    .sub .side{
      position:absolute; top:0; left:calc(100% + 12px); width:340px;
      background:rgba(17,26,45,.98); border:1px solid rgba(255,255,255,.06);
      border-radius:12px; box-shadow:0 12px 30px rgba(0,0,0,.35);
      padding:8px; opacity:0; transform:translateX(-6px) scale(0.98);
      pointer-events:none; transition:opacity .12s ease-out, transform .12s cubic-bezier(.18,.89,.32,1.28);
      display:flex; flex-direction:column;
    }
    .nav-folder[data-sticky="true"][data-panel="show"][aria-open="true"] .side{ opacity:1; transform:translateX(0) scale(1); pointer-events:auto; }
    .side-title{margin:6px 10px 8px;font-weight:800;color:#f3f5f8}
    .side-list{list-style:none;margin:0;padding:0; flex:1; overflow:auto}
    .side-list a{display:block;padding:10px 12px;border-radius:8px;color:var(--text);text-decoration:none}
    .side-list a:hover{background:rgba(255,159,26,.1);border:1px solid rgba(255,159,26,.25)}

    .side .side-title, .side .side-list { transition: opacity .12s ease, transform .12s ease; will-change: opacity, transform; }
    .side.swap-out .side-title, .side.swap-out .side-list { opacity: 0; transform: translateX(-6px); }
    .side.swap-in  .side-title, .side.swap-in  .side-list { opacity: 1; transform: translateX(0); }

    /* ===== Scroll ===== */
    .sub>ul::-webkit-scrollbar{width:10px}
    .sub>ul::-webkit-scrollbar-thumb{background:rgba(255,159,26,.2);border-radius:10px}
    .sub>ul::-webkit-scrollbar-track{background:rgba(255,255,255,.04)}

    @media (max-width:860px){
      .sub{position:static}
      .sub>ul,.sub .side{box-shadow:none}
      .sub .side{position:static;left:auto;width:auto;margin-top:8px;opacity:1;transform:none}
      .sub::after{display:none}
    }

    /* ====== HERO / CONTENIDO ====== */
    .hero-wrap{
      min-height:52vh;
      display:flex;align-items:center;justify-content:center;text-align:center;
      padding:0 14px 0;
      margin-top:var(--hero-offset);
    }
    .hero h1{font-size:clamp(34px,4vw,54px);font-weight:900;color:var(--accent);margin:0 0 6px;
      text-shadow:0 0 18px rgba(255,159,26,.7),0 0 36px rgba(255,159,26,.25)}
    .hero h2{font-size:clamp(24px,3.2vw,40px);font-weight:800;margin:4px 0 8px;color:var(--accent-soft);
      text-shadow:0 0 14px rgba(255,159,26,.45)}
    .cursor{display:inline-block;width:.6ch;margin-left:2px;color:var(--accent);filter:drop-shadow(0 0 6px var(--accent));animation:blink .95s steps(1,end) infinite}
    @keyframes blink{50%{opacity:0}}
    .lead{max-width:900px;margin:6px auto 0;font-size:clamp(19px,1.5vw,22px);line-height:1.7;color:var(--text);opacity:0;transform:translateY(10px);transition:opacity .8s ease,transform .8s ease}
    .lead.show{opacity:1;transform:none}

    .container{width:min(1100px,92%);margin:0 auto}
    section{padding:26px 0}
    .section-title{font-size:clamp(24px,3vw,34px);margin:0 0 10px}
    .kicker{color:var(--muted);margin:0 0 20px}
    .chips{display:flex;flex-wrap:wrap;gap:10px}
    .chip{padding:8px 12px;border-radius:999px;background:rgba(255,159,26,.12);border:1px solid rgba(255,159,26,.35);color:#ffe2b0;font-weight:600;font-size:14px}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:18px}
    .card{background:linear-gradient(180deg,color-mix(in oklab,var(--panel) 92%,#0f1422 8%),var(--panel));border:1px solid rgba(255,255,255,.06);border-radius:var(--radius);padding:16px}
    .project img{width:100%;aspect-ratio:16/10;object-fit:cover;border-radius:10px;border:1px solid rgba(255,255,255,.06)}
    .project h4{margin:10px 0 6px}
    .project p{margin:0;color:var(--muted)}
    .contact-box{display:grid;grid-template-columns:1.1fr .9fr;gap:22px}
    form{display:grid;gap:12px}
    input,textarea{background:#0c1323;color:var(--text);border:1px solid rgba(255,255,255,.12);border-radius:10px;padding:12px 14px;font-size:16px}
    textarea{min-height:140px;resize:vertical}
    footer{padding:40px 0;color:#a9b1bd;text-align:center;border-top:1px solid rgba(255,255,255,.06);margin-top:10px}

    @media (max-width:980px){.grid{grid-template-columns:1fr 1fr}.contact-box{grid-template-columns:1fr}}
    @media (max-width:620px){.grid{grid-template-columns:1fr}}

    /* ===== Enfatizar subcarpetas Lvl 2 (Portafolio) ===== */
    .nav-folder[data-sticky="true"] .nested > li > a{
      position: relative;
      border: 1px solid rgba(255,159,26,.15);
      background: transparent;
      border-radius: 10px;
      transition: background .18s ease, border-color .18s ease, box-shadow .18s ease, transform .14s ease, color .18s ease;
      padding: 10px 12px;
    }
    .nav-folder[data-sticky="true"] .nested > li > a::before{
      content:"";
      position:absolute;
      left:6px; top:10px; bottom:10px;
      width:3px; border-radius:2px;
      background:transparent;
      transition: background .18s ease, transform .14s ease;
    }
    .nav-folder[data-sticky="true"] .nested > li.focus2 > a,
    .nav-folder[data-sticky="true"] .nested > li > a:hover{
      background: linear-gradient(90deg, rgba(255,159,26,.18) 0%, rgba(255,159,26,.08) 60%);
      border-color: rgba(255,159,26,.55);
      box-shadow: 0 6px 18px rgba(255,159,26,.25), inset 0 0 0 1px rgba(255,255,255,.06);
      transform: translateX(2px);
      color: #ffe1a6;
    }
    .nav-folder[data-sticky="true"] .nested > li.focus2 > a::before,
    .nav-folder[data-sticky="true"] .nested > li > a:hover::before{
      background: var(--accent);
      transform: scaleX(1.5);
    }
    .nav-folder[data-sticky="true"] .sub > ul > li.open > .nested{
      filter: drop-shadow(0 6px 20px rgba(255,159,26,.15));
    }

    /* ===== Paginación del panel lateral (lvl3) ===== */
    .side .pager{
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      margin:10px 6px 4px;
      padding-top:6px; border-top:1px dashed rgba(255,255,255,.08);
    }
    .pager-info{font-size:12px; opacity:.7; user-select:none}
    .pager-btn{
      position:relative; width:38px; height:32px; border-radius:10px;
      background:rgba(255,159,26,.10); border:1px solid rgba(255,159,26,.35);
      cursor:pointer; font-weight:800;
      display:inline-flex; align-items:center; justify-content:center;
      transition:transform .12s ease, background .18s ease, border-color .18s ease, opacity .18s ease;
      color:#ffd8a6;
    }
    .pager-btn:hover{ transform:translateY(-1px); background:rgba(255,159,26,.18); border-color:rgba(255,159,26,.6); }
    .pager-btn:disabled{ opacity:.45; cursor:not-allowed; transform:none; }
    .pager-btn.prev::before,
    .pager-btn.next::before{ content:"›"; font-size:18px; line-height:1; }
    .pager-btn.prev::before{ transform:rotate(180deg); }
    .pager-btn::after{
      content:attr(data-page);
      position:absolute; right:-6px; top:-8px;
      font-size:12px; line-height:1; padding:2px 6px; border-radius:999px;
      background:var(--accent); color:#111; box-shadow:0 4px 14px rgba(0,0,0,.35);
      border:1px solid rgba(255,255,255,.25);
    }

    /* ============================================================
       ========  CARRUSEL DE CUBOS (placeholder)  =================
       Mantiene la estética y variables. 5 visibles en desktop.
       ============================================================ */
    .cube-carousel{
      position:relative;
      overflow:hidden;
      border-radius:var(--radius);
      background:linear-gradient(180deg,color-mix(in oklab,var(--panel) 92%,#0f1422 8%),var(--panel));
      border:1px solid rgba(255,255,255,.06);
      padding:14px;
    }
    .cube-head{
      display:flex; align-items:baseline; justify-content:center; gap:12px; /* centrado */
      margin-bottom:10px;
      text-align:center;
    }
    .cube-head h3{margin:0; font-size:clamp(20px,2.2vw,26px)}
    .cube-track{
      display:flex;
      gap:14px;
      will-change: transform;
      transition: transform .6s cubic-bezier(.22,.61,.36,1);
    }
    .cube{
      flex:0 0 calc((100% - 14px*4)/5); /* 5 visibles con 4 gaps */
      background:#0c1323;
      border:1px solid rgba(255,255,255,.08);
      border-radius:12px;
      overflow:hidden;
      box-shadow:0 6px 18px rgba(0,0,0,.22);
      display:flex; flex-direction:column;
    }
    .cube:hover{ border-color:rgba(255,159,26,.35); box-shadow:0 10px 28px rgba(255,159,26,.12); transform:translateY(-1px); transition:transform .12s ease }
    .cube-media{
      width:100%; aspect-ratio:16/10; background:#0a1020; position:relative;
      border-bottom:1px solid rgba(255,255,255,.06);
    }
    .cube-media img{position:absolute; inset:0; width:100%; height:100%; object-fit:cover}
    .cube-body{padding:10px 12px 12px; display:flex; flex-direction:column; gap:8px}
    .cube-title{margin:0; font-weight:800; font-size:15.5px; color:var(--text)}
    .cube-meta{font-size:12.5px; color:var(--muted)}
    .cube-link{
      margin-top:auto;
      align-self:flex-start;
      text-decoration:none; font-weight:700; font-size:13.5px;
      color:#ffe2b0; padding:6px 10px; border-radius:999px;
      background:rgba(255,159,26,.12); border:1px solid rgba(255,159,26,.35);
      transition:background .18s,border-color .18s,transform .12s;
    }
    .cube-link:hover{ background:rgba(255,159,26,.18); border-color:rgba(255,159,26,.6); transform:translateY(-1px) }

    /* Flechas */
    .cube-nav{
      position:absolute; inset:0; pointer-events:none;
    }
    .cube-btn{
      position:absolute; top:50%; translate:0 -50%;
      width:42px; height:42px; border-radius:999px;
      background:rgba(17,26,45,.75);
      border:1px solid rgba(255,255,255,.08);
      display:flex; align-items:center; justify-content:center;
      font-weight:900; color:#ffd79a; cursor:pointer;
      opacity:0; pointer-events:none;
      transition:opacity .18s ease, transform .12s ease, background .18s ease, border-color .18s ease;
      box-shadow:0 4px 16px rgba(0,0,0,.35);
    }
    .cube-btn:hover{ transform:translateY(-1px); background:rgba(17,26,45,.9); border-color:rgba(255,159,26,.35) }
    .cube-btn.prev{ left:6px }
    .cube-btn.next{ right:6px }
    .cube-carousel:hover .cube-btn,
    .cube-carousel:has(.cube-btn:focus-visible){ opacity:1; pointer-events:auto }

    /* Indicadores */
    .cube-dots{ display:flex; gap:6px; justify-content:center; margin-top:12px }
    .cube-dot{
      width:7px; height:7px; border-radius:999px;
      background:rgba(255,255,255,.22);
      transition:transform .12s, background .18s, box-shadow .18s;
    }
    .cube-dot.is-active{
      background:var(--accent);
      box-shadow:0 0 10px rgba(255,159,26,.6);
      transform:scale(1.25);
    }
    /* Responsive: 3 y 2/1 visibles */
    @media (max-width:1020px){ .cube{ flex-basis:calc((100% - 14px*2)/3) } }
    @media (max-width:720px) { .cube{ flex-basis:calc((100% - 14px)/2) } }
    @media (max-width:520px) { .cube{ flex-basis:100% } }

    /* Reduce motion: desactivar autoplay */
    @media (prefers-reduced-motion: reduce){
      .cube-track{ transition:none }
    }
  </style>
<body>

  <!-- ========================= NAV ========================== -->
  <header class="topbar">
    <div class="topwrap">
      <a class="brand" href="./"><span class="brand-dot"></span><span>AO · Portafolio</span></a>

      <!-- Menú izquierda (nuevo orden) -->
      <nav class="menu-left" id="nav" aria-label="Navegación principal"></nav>

      <!-- Menú derecha: Inicio -->
      <nav class="menu-right">
        <a class="nav-link" href="./">Inicio</a>
      </nav>
    </div>
  </header>

  <!-- ========================= HERO ========================== -->
  <div id="home" class="hero-wrap">
    <div class="hero">
      <h1><span id="typeName"></span></h1>
      <h2><span id="typeRole"></span><span class="cursor">|</span></h2>
      <p id="lead" class="lead">Me especializo en diseñar, securizar y operar infraestructuras robustas. Automatizo despliegues, fortalezco defensas y mejoro la fiabilidad de servicios con prácticas DevOps/SecOps.</p>
    </div>
  </div>

  <!-- ========================= CONTENIDO ========================== -->
  <main class="container">
    <section id="ciber" aria-labelledby="ciber-title">
      <h2 id="ciber-title" class="section-title">Ciberseguridad</h2>
      <p class="kicker">Security-by-design, hardening y respuesta a incidentes.</p>
      <div class="card">Playbooks de respuesta, aplicación de guías CIS, inventario de activos y SIEM; priorización de riesgos y monitoreo proactivo.</div>
    </section>

    <section id="adm" aria-labelledby="adm-title">
      <h2 id="adm-title" class="section-title">Administración de Sistemas</h2>
      <p class="kicker">Infraestructura reproducible y observable.</p>
      <div class="card">Linux/Windows, IaC (Terraform/Ansible), contenedores (Docker/K8s), redes y servidores (Nginx/Apache), CI/CD y observabilidad.</div>
    </section>

    <section id="skills" aria-labelledby="skills-title">
      <h2 id="skills-title" class="section-title">Skills principales</h2>
      <div class="chips">
        <span class="chip">Linux</span><span class="chip">Windows Server</span><span class="chip">Networking</span>
        <span class="chip">Docker</span><span class="chip">Kubernetes</span><span class="chip">Ansible</span>
        <span class="chip">Terraform</span><span class="chip">Bash / PowerShell</span><span class="chip">CI/CD</span>
        <span class="chip">Nginx / Apache</span><span class="chip">SIEM</span><span class="chip">Hardening</span><span class="chip">Cloud (AWS/Azure)</span>
      </div>
    </section>

    <section id="projects" aria-labelledby="projects-title">
      <h2 id="projects-title" class="section-title">Proyectos destacados</h2>
      <div class="grid">
        <article class="card project">
          <img src="assets/proyecto1.jpg" alt="Miniatura del Proyecto 1" loading="lazy" />
          <h4>Infraestructura reproducible con IaC</h4>
          <p>Terraform + Ansible para levantar entornos seguros y auditables en AWS. Módulos reutilizables y pipelines CI.</p>
        </article>
        <article class="card project">
          <img src="assets/proyecto2.jpg" alt="Miniatura del Proyecto 2" loading="lazy" />
          <h4>Plataforma de observabilidad</h4>
          <p>Stack Prometheus + Loki + Grafana con alertas y SLOs para microservicios en Kubernetes.</p>
        </article>
        <article class="card project">
          <img src="assets/proyecto3.jpg" alt="Miniatura del Proyecto 3" loading="lazy" />
          <h4>Hardening y respuesta a incidentes</h4>
          <p>Guías CIS aplicadas, inventario de activos y playbooks de respuesta con herramientas open-source.</p>
        </article>
      </div>
    </section>

    <!-- =======================================================
         NUEVA SECCIÓN: Carrusel de cubos (contenido placeholder)
         ======================================================= -->
    <section id="news-cubes" aria-labelledby="news-cubes-title">
      <h2 id="news-cubes-title" class="section-title">Lecturas y artículos</h2>
      <p class="kicker">Novedades seleccionadas — desplazamiento suave y continuo.</p>

      <div class="cube-carousel" data-autoplay="true" data-interval="3200" data-shuffle="true" aria-roledescription="carrusel">
        <div class="cube-head">
          <h3>Artículos interesantes</h3>
        </div>

        <div class="cube-viewport" role="region" aria-label="Carrusel de artículos" style="overflow:hidden">
          <div class="cube-track" id="cubeTrack" role="list"></div>
        </div>

        <div class="cube-nav" aria-hidden="false">
          <button class="cube-btn prev" type="button" id="cubePrev" aria-label="Artículo anterior">‹</button>
          <button class="cube-btn next" type="button" id="cubeNext" aria-label="Artículo siguiente">›</button>
        </div>

        <div class="cube-dots" id="cubeDots" aria-hidden="true"></div>
      </div>
    </section>
    <!-- /CARRUSEL -->

    <section id="contact" aria-labelledby="contact-title">
      <h2 id="contact-title" class="section-title">Contacto</h2>
      <div class="contact-box">
        <div class="card">
          <p>¿Tienes un proyecto o una consulta técnica? Escríbeme y te respondo.</p>
          <p><strong>Email:</strong> <a href="mailto:alex@tu-dominio.com">alex@tu-dominio.com</a></p>
          <p><strong>LinkedIn:</strong> <a href="https://www.linkedin.com/in/tuusuario" target="_blank" rel="noopener">linkedin.com/in/tuusuario</a></p>
        </div>
        <div class="card">
          <form action="mailto:alex@tu-dominio.com" method="post" enctype="text/plain">
            <label>Nombre<br><input name="nombre" required /></label>
            <label>Email<br><input name="email" type="email" required /></label>
            <label>Mensaje<br><textarea name="mensaje" required></textarea></label>
            <button type="submit" style="background:var(--accent);color:#111;padding:10px 16px;border-radius:10px;border:0;font-weight:700">Enviar</button>
          </form>
        </div>
      </div>
    </section>
  </main>

  <footer>© <span id="y"></span> Alejandro Orcajada Meseguer — Administrador de Sistemas y Ciberseguridad</footer>

  <!-- ========================= SCRIPTS ========================== -->
  <script>
    /* ===== Año ===== */
    document.getElementById('y').textContent = new Date().getFullYear();

    /* ===== Doble typing ===== */
    const nameText = "Alejandro Orcajada Meseguer";
    const roleText = "Administrador de Sistemas y Ciberseguridad";
    const speed = 44;
    const elName = document.getElementById('typeName');
    const elRole = document.getElementById('typeRole');
    const cursor = document.querySelector('.cursor');
    const lead = document.getElementById('lead');
    let i=0,j=0;
    function typeName(){ if(i<nameText.length){ elName.textContent += nameText.charAt(i++); setTimeout(typeName,speed); } else { setTimeout(typeRole,250);} }
    function typeRole(){ if(j<roleText.length){ elRole.textContent += roleText.charAt(j++); setTimeout(typeRole,speed); } else { cursor.remove(); lead.classList.add('show'); } }
    setTimeout(typeName,300);

    /* ===== Datos del NAV ===== */
    const twelve = base => Array.from({length:12}, (_,i)=>({label:`${base} · Artículo ${i+1}`, href:"#"}));

    const NAV_TREE = [
      { label:"Teoría y Casos Curiosos", children:[
        { label:"Ciberseguridad", href:"#", children:[
          { label:"Análisis Forense", href:"#", children: twelve("Teoría · Forense") },
          { label:"Respuesta a Incidentes", href:"#", children: twelve("Teoría · Incidentes") }
        ]},
        { label:"Sistemas", href:"#", children:[
          { label:"Redes", href:"#", children: twelve("Teoría · Redes") },
          { label:"Conceptos", href:"#", children: twelve("Teoría · Conceptos") }
        ]}
      ]},

      { label:"Portafolio", sticky:true, children:[
        { label:"Ciberseguridad", href:"/portafolio/Ciberseguridad/", children:[
          { label:"Análisis Forense", href:"#", children: twelve("Análisis Forense") },
          { label:"DevSecOps", href:"#", children: twelve("DevSecOps") },
          { label:"Documentación e informes", href:"#", children: twelve("Docs e informes") },
          { label:"Puesta en producción segura", href:"#", children: twelve("Producción segura") },
          { label:"Respuesta a Incidentes", href:"#", children: twelve("Respuesta a Incidentes") },
          { label:"Seguridad en redes", href:"#", children: twelve("Seguridad en redes") },
          { label:"Seguridad de sistemas", href:"#", children: twelve("Seguridad de sistemas") }
        ]},
        { label:"Sistemas", href:"/portafolio/sistemas/", children:[
          { label:"Linux", href:"#", children: twelve("Linux") },
          { label:"Windows", href:"#", children: twelve("Windows") },
          { label:"Automatización", href:"#", children: twelve("Automatización") }
        ]}
      ]},

      { label:"Laboratorio", href:"/Laboratorio/", children:[
        { label:"TryHackMe", href:"#", children: twelve("THM") },
        { label:"HackTheBox", href:"#", children: twelve("HTB") }
      ]},

      { label:"Contacto", href:"/contacto/" }
    ];

    /* === swap animado + paginación (6 por página) === */
    function swapSideContent(sideEl, newTitle, newLinksArray) {
      const titleEl = sideEl.querySelector('.side-title');
      sideEl._pagesByKey = sideEl._pagesByKey || new Map();

      const perPage = 6;
      const pages = chunkArray(newLinksArray, perPage);

      const key = newTitle;
      const prevState = sideEl._pagesByKey.get(key) || { page: 0, pages: [] };
      const state = { page: Math.min(prevState.page, Math.max(pages.length - 1, 0)), pages };
      sideEl._pagesByKey.set(key, state);

      if (sideEl.dataset.key !== newTitle) {
        sideEl.classList.remove('swap-in');
        sideEl.classList.add('swap-out');
        clearTimeout(sideEl._swapTimer);
        const OUT_MS = 120;

        sideEl._swapTimer = setTimeout(() => {
          sideEl.dataset.key = newTitle;
          titleEl.textContent = newTitle;
          renderSidePage(sideEl, state);
          void sideEl.offsetWidth;
          sideEl.classList.remove('swap-out');
          sideEl.classList.add('swap-in');
        }, OUT_MS);
      } else {
        renderSidePage(sideEl, state);
      }
    }

function renderSidePage(sideEl, state){
  const listEl = sideEl.querySelector('.side-list');
  listEl.innerHTML = '';

  const current = state.pages[state.page] || [];
  current.forEach(a => {
    const li = document.createElement('li');
    li.appendChild(a.cloneNode(true));
    listEl.appendChild(li);
  });

  let pager = sideEl.querySelector('.pager');
  if (!pager) {
    pager = document.createElement('div');
    pager.className = 'pager';
    sideEl.appendChild(pager);
  }
  pager.innerHTML = '';

  const prev = document.createElement('button');
  prev.className = 'pager-btn prev';
  prev.title = 'Página anterior';
  prev.disabled = state.page === 0;
  prev.dataset.page = state.page > 0 ? (state.page) : '';

  const next = document.createElement('button');
  next.className = 'pager-btn next';
  next.title = 'Página siguiente';
  next.disabled = state.page >= state.pages.length - 1;
  next.dataset.page = state.page < state.pages.length - 1 ? (state.page + 2) : '';

  const info = document.createElement('span');
  info.className = 'pager-info';
  info.textContent = `Página ${state.page + 1} de ${state.pages.length}`;

  // ✅ Evitar perder foco/cerrar panel al usar paginación y mantenerlo abierto
  [prev, next].forEach(b=>{
    b.addEventListener('mousedown', e => e.preventDefault()); // evita blur por mousedown
    b.addEventListener('click', () => {
      const folder = b.closest('.nav-folder');
      if (folder) setOpen(folder, true);
    });
  });

  // Handlers reales de paginación
  prev.addEventListener('click', () => {
    if (state.page > 0) { state.page--; renderSidePage(sideEl, state); }
  });
  next.addEventListener('click', () => {
    if (state.page < state.pages.length - 1) { state.page++; renderSidePage(sideEl, state); }
  });

  pager.append(info, prev, next);
}
    function chunkArray(arr, size){
      const out = [];
      for(let i=0;i<arr.length;i+=size) out.push(arr.slice(i, i+size));
      return out;
    }

    /* === Alinear panel lvl3 al item lvl2 dentro del marco (sub > ul) === */
    function positionSideAligned(sideEl, anchorEl, subEl){
      const listEl   = subEl.querySelector(':scope > ul');
      const subRect  = subEl.getBoundingClientRect();
      const listRect = listEl.getBoundingClientRect();
      const aRect    = anchorEl.getBoundingClientRect();
      const sideH    = sideEl.getBoundingClientRect().height;

      const desiredTop = aRect.top - subRect.top;
      const minTop     = listRect.top - subRect.top;
      const maxTop     = (listRect.bottom - subRect.top) - sideH;

      let top;
      if (maxTop < minTop) top = minTop; else top = Math.min(Math.max(desiredTop, minTop), maxTop);
      sideEl.style.top = `${top}px`;
    }

    /* ===== Render NAV (izquierda) ===== */
function renderNav(tree){
  const nav = document.getElementById('nav');
  tree.forEach(node => nav.appendChild(createNode(node)));

  // hover-intent primer nivel
  const timers = new WeakMap();
  document.querySelectorAll('.nav-folder').forEach(folder=>{
    folder.addEventListener('mouseenter', ()=>{
      const t = timers.get(folder); if(t) clearTimeout(t);
      setOpen(folder, true);
    });
    folder.addEventListener('mouseleave', ()=>{
      const t = setTimeout(()=> setOpen(folder,false,true), 220);
      timers.set(folder,t);
    });
  });

  // Cerrar solo si el click es FUERA del folder abierto (en burbuja)
  document.addEventListener('click', (e)=>{
    // 👇 ignorar clicks en los botones de paginación
    if (e.target.closest('.pager-btn')) return;

    const anyOpen = document.querySelector('.nav-folder[aria-open="true"]');
    if(anyOpen && !anyOpen.contains(e.target)) setOpen(anyOpen,false,true);
  });

  // Mantener abierto al usar la paginación (en burbuja y SIN stopPropagation)
  document.addEventListener('click', (e)=>{
    const btn = e.target.closest('.pager-btn');
    if (!btn) return;
    const folder = btn.closest('.nav-folder');
    if (folder) setOpen(folder, true);
  });
}

    /* ===== Crear nodo ===== */
    function createNode(node){
      if(!node.children){
        const a=document.createElement('a');
        a.className='nav-link';
        a.href=node.href||'#';
        a.textContent=node.label;
        return a;
      }

      const wrap=document.createElement('div');
      wrap.className='nav-folder';
      wrap.setAttribute('aria-open','false');
      if (node.label === "Portafolio") wrap.dataset.sticky = "true";

      const btn=document.createElement('button');
      btn.className='nav-btn';
      btn.setAttribute('aria-expanded','false');
      btn.setAttribute('aria-haspopup','true');
      const labelHTML = node.href ? `<a href="${node.href}" class="nav-btn-link">${node.label}</a>` : `<span>${node.label}</span>`;
      btn.innerHTML=`<span class="ico-folder"></span>${labelHTML}<span class="caret"></span>`;
      wrap.appendChild(btn);

      const sub=document.createElement('div'); sub.className='sub';
      const ul=document.createElement('ul'); sub.appendChild(ul);

      // panel lateral lvl3 sólo en Portafolio
      let side = null;
      if (wrap.dataset.sticky === "true") {
        side = document.createElement('div');
        side.className = 'side';
        side.innerHTML = `<div class="side-title">Selecciona una subcarpeta…</div><ul class="side-list"></ul>`;
        sub.appendChild(side);
      }

      // Lvl1
      node.children.forEach(childLvl1=>{
        const liLvl1=document.createElement('li');

        const link1=document.createElement('a');
        link1.href=childLvl1.href||'#';
        link1.innerHTML=`<span>${childLvl1.label}</span><span style="opacity:.6">›</span>`;
        liLvl1.appendChild(link1);

        const ulLvl2=document.createElement('ul'); ulLvl2.className='nested';

        childLvl1.children?.forEach(childLvl2=>{
          const liLvl2=document.createElement('li');
          const link2=document.createElement('a');
          link2.href=childLvl2.href||'#';
          link2.innerHTML=`<span>${childLvl2.label}</span><span style="opacity:.6">›</span>`;
          liLvl2.appendChild(link2);

          const hiddenLvl3=document.createElement('ul'); hiddenLvl3.style.display='none';
          childLvl2.children?.forEach(a3=>{
            const li3=document.createElement('li');
            const a=document.createElement('a');
            a.href=a3.href||'#'; a.textContent=a3.label;
            li3.appendChild(a); hiddenLvl3.appendChild(li3);
          });
          liLvl2.appendChild(hiddenLvl3);

          if (wrap.dataset.sticky === "true") {
            link2.addEventListener('mouseenter', ()=>{
              const linksLvl3 = Array.from(hiddenLvl3.querySelectorAll('a'));
              const newTitle  = `${childLvl1.label} / ${childLvl2.label}`;

              positionSideAligned(side, link2, sub);
              swapSideContent(side, newTitle, linksLvl3);
              wrap.setAttribute('data-panel','show');
              setTimeout(()=> positionSideAligned(side, link2, sub), 0);
            });

            /* énfasis sincronizado (Lvl 2) */
            link2.addEventListener('mouseenter', ()=>{
              liLvl2.classList.add('focus2');
              liLvl2.parentElement
                .querySelectorAll(':scope > li.focus2')
                .forEach(sib => { if (sib !== liLvl2) sib.classList.remove('focus2'); });
            });
            liLvl2.addEventListener('mouseleave', ()=> liLvl2.classList.remove('focus2'));
            link2.addEventListener('focus', ()=> liLvl2.classList.add('focus2'));
            link2.addEventListener('blur' , ()=> liLvl2.classList.remove('focus2'));
          }

          ulLvl2.appendChild(liLvl2);
        });

        liLvl1.appendChild(ulLvl2);
        ul.appendChild(liLvl1);

        link1.addEventListener('mouseenter', ()=>{ liLvl1.classList.add('open'); });
      });

      btn.addEventListener('click', e=>{
        e.preventDefault();
        const open = wrap.getAttribute('aria-open')==='true';
        setOpen(wrap, !open);
      });

      btn.addEventListener('keydown', e=>{
        if(e.key==='Escape') setOpen(wrap,false,true);
        if(e.key==='ArrowDown'){ setOpen(wrap,true); ul.querySelector('a')?.focus(); }
      });

      wrap.appendChild(sub);
      return wrap;
    }

    function setOpen(folder, open, resetInternos=false){
      folder.setAttribute('aria-open', open?'true':'false');
      folder.querySelector('.nav-btn').setAttribute('aria-expanded', open?'true':'false');

      if(open){
        document.querySelectorAll('.nav-folder').forEach(f=>{
          if(f!==folder){
            f.setAttribute('aria-open','false');
            f.querySelector('.nav-btn').setAttribute('aria-expanded','false');
            f.removeAttribute('data-panel');
          }
        });
      } else if (resetInternos){
        folder.removeAttribute('data-panel');
        folder.querySelectorAll(':scope .sub > ul > li').forEach(li=>li.classList.remove('open'));
      }
    }

    // Init
    renderNav(NAV_TREE);

    /* ============================================================
       ===============  CARRUSEL DE CUBOS (JS)  ===================
       Placeholder data + autoplay, pausa en hover/focus,
       flechas, dots, swipe y reduce-motion.
       ============================================================ */
    (function initCubeCarousel(){
      const root = document.querySelector('.cube-carousel');
      if(!root) return;

      const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      const autoplay = root.dataset.autoplay === 'true' && !prefersReduced;
      const intervalMs = parseInt(root.dataset.interval || '3200', 10);
      const shuffle = root.dataset.shuffle === 'true';

      const track = document.getElementById('cubeTrack');
      const dotsEl = document.getElementById('cubeDots');
      const btnPrev = document.getElementById('cubePrev');
      const btnNext = document.getElementById('cubeNext');

      // Datos placeholder (inventados)
      const ITEMS = Array.from({length:12}).map((_,i)=>({
        id: i+1,
        titulo: `Artículo ${i+1}: Placeholder`,
        resumen: `Resumen breve del contenido ${i+1}. Texto ficticio para probar el layout.`,
        img: `assets/placeholder_${(i%6)+1}.jpg`,
        href: "#"
      }));

      if(shuffle) ITEMS.sort(()=>Math.random()-.5);

      // Construir DOM (duplicamos para bucle infinito)
      const makeCube = (item) => {
        const li = document.createElement('article');
        li.className = 'cube';
        li.setAttribute('role','listitem');
        li.innerHTML = `
          <div class="cube-media"><img src="${item.img}" alt="Imagen del ${item.titulo}" loading="lazy"></div>
          <div class="cube-body">
            <h4 class="cube-title">${item.titulo}</h4>
            <div class="cube-meta">${item.resumen}</div>
            <a class="cube-link" href="${item.href}">Ver más</a>
          </div>
        `;
        return li;
      };

      const baseNodes = ITEMS.map(makeCube);
      const cloneNodes = ITEMS.map(makeCube); // segunda tanda
      baseNodes.forEach(n=>track.appendChild(n));
      cloneNodes.forEach(n=>track.appendChild(n));

      track.setAttribute('role','list');

      // Dots (para la tanda base)
      ITEMS.forEach((_,idx)=>{
        const d = document.createElement('span');
        d.className = 'cube-dot' + (idx===0?' is-active':'');
        dotsEl.appendChild(d);
      });

      // Estado
      let index = 0;
      let timer = null;
      let isPaused = false;
      let itemWidth = () => (track.querySelector('.cube')?.getBoundingClientRect().width || 0) + 14; // ancho + gap
      let max = ITEMS.length;

      const setActiveDot = (i)=>{
        const dots = Array.from(dotsEl.children);
        dots.forEach((el,ix)=> el.classList.toggle('is-active', ix === (i % max)));
      };

      const jumpIfNeeded = ()=>{
        if(index >= max){
          index = index % max;
          track.style.transition = 'none';
          track.style.transform = `translateX(${-index*itemWidth()}px)`;
          void track.offsetWidth;
          track.style.transition = '';
        } else if(index < 0){
          index = (index + max) % max + max;
          track.style.transition = 'none';
          track.style.transform = `translateX(${-index*itemWidth()}px)`;
          void track.offsetWidth;
          track.style.transition = '';
        }
      };

      const goTo = (i)=>{
        index = i;
        track.style.transform = `translateX(${-index*itemWidth()}px)`;
        setActiveDot(index);
      };
      const next = ()=>{ goTo(index+1); };
      const prev = ()=>{ goTo(index-1); };

      const start = ()=>{
        if(timer || !autoplay) return;
        timer = setInterval(()=>{ next(); jumpIfNeeded(); }, intervalMs);
      };
      const stop = ()=>{
        clearInterval(timer); timer = null;
      };

      // Pausa en hover/focus dentro del carrusel
      root.addEventListener('mouseenter', ()=>{ isPaused=true; stop(); });
      root.addEventListener('mouseleave', ()=>{ isPaused=false; start(); });
      root.addEventListener('focusin', ()=>{ isPaused=true; stop(); });
      root.addEventListener('focusout', ()=>{ if(!isPaused) start(); });

      // Flechas
      btnNext.addEventListener('click', ()=>{ stop(); next(); jumpIfNeeded(); });
      btnPrev.addEventListener('click', ()=>{ stop(); prev(); jumpIfNeeded(); });

      // Swipe táctil
      let touchX = null, deltaX = 0, swiping = false;
      root.addEventListener('touchstart', (e)=>{
        touchX = e.touches[0].clientX; deltaX = 0; swiping = true; stop();
      }, {passive:true});
      root.addEventListener('touchmove', (e)=>{
        if(!swiping) return;
        deltaX = e.touches[0].clientX - touchX;
        track.style.transition = 'none';
        track.style.transform = `translateX(${-(index*itemWidth()) + deltaX}px)`;
      }, {passive:true});
      root.addEventListener('touchend', ()=>{
        track.style.transition = '';
        if(Math.abs(deltaX) > itemWidth()*0.25){
          if(deltaX < 0) next(); else prev();
          jumpIfNeeded();
        } else {
          goTo(index);
        }
        swiping = false; if(!prefersReduced) start();
      });

      // Recalcular en resize
      window.addEventListener('resize', ()=>{ goTo(index); });

      // Arrancar
      goTo(0);
      if(autoplay) start();
    })();
  </script>
</body>
</html>
